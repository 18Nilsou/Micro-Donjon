openapi: 3.0.0
info:
  title: Dungeon Service API
  description: API de gestion des donjons
  version: 1.0.0
servers:
  - url: http://localhost:3003

paths:
  /dungeons:
    get:
      summary: Récupérer tous les donjons
      tags:
        - Dungeons
      responses:
        '200':
          description: Liste des donjons
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Dungeon'
        '500':
          description: Erreur interne du serveur

    post:
      summary: Créer un nouveau donjon
      tags:
        - Dungeons
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GenerateDungeonRequest'
      responses:
        '201':
          description: Donjon créé avec succès
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Dungeon'
        '400':
          description: Données invalides
        '500':
          description: Erreur interne du serveur

  /dungeons/{id}:
    get:
      summary: Récupérer un donjon par son ID
      tags:
        - Dungeons
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Détails du donjon
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Dungeon'
        '404':
          description: Donjon non trouvé
        '500':
          description: Erreur interne du serveur

components:
  schemas:
    GenerateDungeonRequest:
      type: object
      required:
        - name
        - numberOfRooms
      properties:
        name:
          type: string
        numberOfRooms:
          type: integer
          minimum: 1

    Dungeon:
      type: object
      required:
        - id
        - name
        - rooms
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        rooms:
          type: array
          items:
            $ref: '#/components/schemas/Room'

    Room:
      type: object
      properties:
        id:
          type: string
          format: uuid
        type:
          $ref: '#/components/schemas/RoomType'
        position:
          $ref: '#/components/schemas/Position'
        dimension:
          $ref: '#/components/schemas/Dimension'
        config:
          $ref: '#/components/schemas/RoomConfig'

    RoomType:
      type: string
      enum:
        - entrance
        - corridor
        - treasure
        - boss
        - trap

    Position:
      type: object
      properties:
        x:
          type: integer
        y:
          type: integer

    Dimension:
      type: object
      properties:
        width:
          type: integer
        height:
          type: integer

    RoomConfig:
      type: object
      properties:
        hasMobs:
          type: boolean
        hasItems:
          type: boolean
        hasTrap:
          type: boolean

    Error:
      type: object
      properties:
        error:
          type: string
        message:
          type: string
